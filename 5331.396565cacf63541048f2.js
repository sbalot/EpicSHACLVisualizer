"use strict";(self.webpackChunkviewer=self.webpackChunkviewer||[]).push([[5331],{5331:function(e,t,n){n.r(t),n.d(t,{default:function(){return K}});var r=n(61751),a=n.n(r),o=(n(94576),n(87462)),i=n(31184),s=(n(6014),n(90645)),c=n(19617),u=n(15861),l=n(98152),p=n(87757),f=n.n(p),d=n(15671),h=n(43144),v=n(60136),m=n(6215),y=n(61120),b=n(46907),g=n(5587),w=n(41591),k=(n(22661),n(45697)),Z=n.n(k);var x=function(e){(0,v.Z)(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,y.Z)(t);if(n){var a=(0,y.Z)(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return(0,m.Z)(this,e)});function o(e){var t;return(0,d.Z)(this,o),(t=r.call(this,e)).state={},t}return(0,h.Z)(o,[{key:"componentDidMount",value:function(){var e,t=this,n=this.setViewer();e=new g.H(n),new w.y(n,{canvasId:"myNavCubeCanvas",visible:!0}),this.props.models.forEach((function(t){var r={id:t,src:t,edges:!0,performance:!0};try{var a=e.load(r);a.on("loaded",(function(){n.cameraFlight.jumpTo(a)}))}catch(e){console.log("error",e)}})),n.scene.camera.projection=this.props.projection||"ortho";var r=null;n.scene.input.on("mousemove",(function(e){var a=n.scene.pick({canvasPos:e});a?r&&a.entity.id===r.id||(r&&(r.opacity=t.state.lastOpacity),r=a.entity,t.setState({lastOpacity:a.entity.opacity}),a.entity.opacity=.6):r&&(r.opacity=t.state.lastOpacity)})),n.cameraControl.on("picked",function(){var e=(0,u.Z)(f().mark((function e(n){var r,a,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.entity)try{n.entity.highlighted=1,r=t.state.viewer.scene.objects,Object.keys(r).forEach((function(e){r[e].id!==n.entity.id&&(r[e].highlighted=!1)})),a=n.entity.model.id,(o=a.split("/")).pop(),o=o.join("/")+"/",n.entity.id,t.props.onSelect([n.entity.id])}catch(e){t.setState({selection:[]})}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.cameraControl.on("pickedNothing",(function(){var e=t.state.viewer.scene.objects;Object.keys(e).forEach((function(t){e[t].highlighted=!1})),t.setState({selection:[]}),t.props.onSelect([])})),this.setState({viewer:n})}},{key:"getGuid",value:function(e){var t=[["0",10],["A",26],["a",26],["_",1],["$",1]].map((function(e){for(var t=[],n=e[0].charCodeAt(0),r=n+e[1],a=n;a<r;++a)t.push(a);return String.fromCharCode.apply(null,t)})).join(""),n=function(e,n){return(n&&4!=n?[0,6]:[0,6,12,18]).map((function(n){return t.substr(parseInt(e/(1<<n))%64,1)})).reverse().join("")},r=e.split("-"),a="";return r.forEach((function(e,t){0<t&&t<r.length-2?a+=e+"-":t===r.length-2&&(a+=e)})),function(e){e=e.replace(/-/g,"");var t=[0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30].map((function(t){return parseInt(e.substr(t,2),16)}));return n(t[0],2)+[1,4,7,10,13].map((function(e){return n((t[e]<<16)+(t[e+1]<<8)+t[e+2])})).join("")}(a)}},{key:"componentDidUpdate",value:function(){var e=this.state.viewer.scene.objects,t=this.props.selection;console.log("props.selection",this.props.selection),t!==this.state.lastQueried&&Object.keys(e).forEach((function(n){t.includes(e[n].id)?e[n].highlighted=!0:e[n].highlighted=!1}))}},{key:"setViewer",value:function(){return new b.A({canvasId:"myCanvas",transparent:!0})}},{key:"render",value:function(){return a().createElement("div",{className:"modelContainer",style:{width:"100%",height:this.props.height}},a().createElement("canvas",{id:"myCanvas",style:{width:"100%",height:this.props.height}}),a().createElement("canvas",{style:{height:"200px",width:"200px",position:"fixed",right:0,bottom:0},className:"navCube",id:"myNavCubeCanvas"}),a().createElement("canvas",{id:"mySectionPlanesOverviewCanvas",className:"sections"}))}}]),o}(r.Component);x.propTypes={projection:Z().oneOf(["ortho","perspective"]),height:Z().number.isRequired,models:Z().array.isRequired,metaModel:Z().string,ifcGuidHandler:Z().func},x.defaultProps={projection:"ortho",ifcGuidHandler:function(e){console.log(e)},onSelect:function(e){console.log("guid",e.guid)}};var S=n(2096),E=n(2268),j=n.n(E),C=n(42830),R=n(48316),A=n.n(R),I=n(57223),O=n.n(I);function q(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D=new S.QueryEngine;function T(e){return G.apply(this,arguments)}function G(){return(G=(0,u.Z)(f().mark((function e(t){var n,r,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t).then((function(e){return e.text()}));case 2:return n=e.sent,r=new(A())({factory:j()}),a=new C.Readable({read:function(){a.push(n),a.push(null)}}),e.abrupt("return",j().dataset().import(r.import(a)));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(){return B=(0,u.Z)(f().mark((function e(t,n,r){var a,o,i,s,c,u,l,p,d,h;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(n);case 2:return a=e.sent,e.next=5,T(t);case 5:return o=e.sent,i=new(O())(a,{factory:j()}),e.next=9,i.validate(o);case 9:s=e.sent,console.log("Console report is ",s.conforms),c=q(s.results),e.prev=12,c.s();case 14:if((u=c.n()).done){e.next=32;break}return l=u.value,console.log(l.message),console.log(l.path),console.log(l.focusNode),e.next=22,D.queryBindings("SELECT *\n        WHERE {\n            <https://www.ugent.be/myAwesomeFirstBIMProject#wall_6335f5c3-1a3d-409c-8baa-86e5028b364b> <http://lbd.arch.rwth-aachen.de/props#globalIdIfcRoot> ?ob.\n            ?ob <https://w3id.org/seas/evaluation> ?ob2.\n            ?ob2 <http://schema.org/value> ?ob3.\n        }",{sources:[t]});case 22:return p=e.sent,console.log(),e.next=26,p.toArray();case 26:return d=e.sent,console.log("final result:",d),h=d.map((function(e){return e.get("ob3").value})),e.abrupt("return",h);case 30:e.next=14;break;case 32:e.next=37;break;case 34:e.prev=34,e.t0=e.catch(12),c.e(e.t0);case 37:return e.prev=37,c.f(),e.finish(37);case 40:case"end":return e.stop()}}),e,null,[[12,34,37,40]])}))),B.apply(this,arguments)}var F=function(e,t,n){return B.apply(this,arguments)},L=n(99226),U=n(22715),_=n(69397),M=function(e){var t=(0,r.useState)(""),n=(0,l.Z)(t,2),o=(n[0],n[1],(0,r.useState)([])),i=(0,l.Z)(o,2),s=i[0],c=i[1],p=(0,r.useState)(new S.QueryEngine),d=(0,l.Z)(p,2),h=(d[0],d[1],(0,r.useState)([])),v=(0,l.Z)(h,2),m=(v[0],v[1],(0,r.useState)([])),y=(0,l.Z)(m,2),b=(y[0],y[1],(0,r.useState)([])),g=(0,l.Z)(b,2),w=(g[0],g[1],(0,r.useState)(!0)),k=(0,l.Z)(w,2),Z=(k[0],k[1],(0,r.useState)("")),E=(0,l.Z)(Z,2),j=E[0],C=E[1],R=(0,r.useState)(""),A=(0,l.Z)(R,2),I=A[0],O=A[1],q=(0,r.useState)(""),N=(0,l.Z)(q,2),D=N[0],T=N[1],G=(0,r.useState)(!1),B=(0,l.Z)(G,2),M=B[0],P=B[1],V=(0,r.useState)(!1),H=(0,l.Z)(V,2),Q=H[0],z=H[1],$=(0,r.useState)(!1),J=(0,l.Z)($,2),W=J[0],K=J[1],X=function(){var e=(0,u.Z)(f().mark((function e(t){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),P(!1),z(!1),K(!1),""==j&&P(!0),""==I&&z(!0),""==D&&K(!0),!(j&&I&&D)){e.next=12;break}return e.next=10,F(j,I,D);case 10:n=e.sent,c((function(e){return n}));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Y(){return(Y=(0,u.Z)(f().mark((function e(t){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("sel",t),c((function(e){return t}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return a().createElement("div",null,a().createElement(L.Z,{component:"form",sx:{"& > :not(style)":{m:1,width:"25ch"}},noValidate:!0,autoComplete:"off"},a().createElement(U.Z,{id:"outlined-basic",variant:"outlined",label:"Data Graph URL",required:!0,onChange:function(e){return C(e.target.value)},error:M}),a().createElement(U.Z,{id:"outlined-basic2",variant:"outlined",required:!0,label:"Shape Graph URL",onChange:function(e){return O(e.target.value)},error:Q}),a().createElement(U.Z,{id:"outlined-basic3",variant:"outlined",label:"GLFT Data Graph URL",onChange:function(e){return T(e.target.value)},error:W}),a().createElement(_.Z,{type:"submit",a:!0,variant:"contained",onClick:X},"View Violations")),e.models.length>0?a().createElement("div",null,a().createElement(x,{height:550,models:e.models,projection:"perspective",onSelect:function(e){return Y.apply(this,arguments)},selection:s})):a().createElement("div",null,a().createElement("p",{style:{paddingTop:"10%"}},"No glTF models selected ")))},P=n(4147);(0,s.Z)((0,c.Z)({})),i.Z.configure((function(e){return"".concat(P.name,"-").concat(e)}));var V=function(e){return e.inactive?a().createElement(a().Fragment,null):a().createElement("div",{style:{margin:30}},a().createElement(M,(0,o.Z)({},e,{models:["https://raw.githubusercontent.com/LBDserver/resources/main/duplex/BIM4Ren_DUNANT_cleaned_IFC2x3.gltf"]})))},H=n(20745),Q=n(38854),z=n.n(Q),$=(n(4147),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;try{var r;r=n?a().createElement(n,t):a().createElement(V,t);var o=J(e);o.render(r)}catch(e){}}),J=z()((function(e){return(0,H.s)(e)})),W=document.querySelector("#a4fead9a-19b3-4663-aecd-b7854874ea34");W&&$(W,{},V);var K=$},4147:function(e){e.exports=JSON.parse('{"name":"viewer","version":"0.1.0","private":true,"port":9002,"dependencies":{"@babel/plugin-transform-runtime":"^7.18.6","@comunica/query-sparql":"^2.2.1","@comunica/query-sparql-file":"^2.3.0","@emotion/react":"^11.9.0","@emotion/styled":"^11.8.1","@mui/material":"^5.7.0","@mui/system":"^5.7.0","@rdfjs/namespace":"^2.0.0","@rdfjs/parser-n3":"^1.1.4","@testing-library/jest-dom":"^5.16.4","@testing-library/react":"^13.1.1","@testing-library/user-event":"^13.5.0","@types/jest":"^27.4.1","@types/node":"^16.11.32","@types/react":"^18.0.8","@types/react-dom":"^18.0.3","@xeokit/xeokit-sdk":"^1.9.0","assert":"^2.0.0","browserify-fs":"^1.0.0","browserify-zlib":"^0.2.0","buffer":"^6.0.3","crypto-browserify":"^3.12.0","events":"^3.3.0","express":"^4.18.1","https-browserify":"^1.0.0","lbdserver-client-api":"file:../../lbdserver-client-api","mem":"^9.0.2","n3":"^1.16.2","os-browserify":"^0.3.0","path-browserify":"^1.0.1","process":"^0.11.10","querystring-es3":"^0.2.1","rdf-ext":"^2.0.1","rdf-utils-fs":"^2.2.0","rdf-validate-shacl":"^0.4.4","react":"^18.1.0","react-dom":"^18.1.0","react-scripts":"5.0.1","react-sizeme":"^3.0.2","stream-browserify":"^3.0.0","stream-http":"^3.2.0","typescript":"^4.6.4","url":"^0.11.0","util":"^0.12.4","web-vitals":"^2.1.4"},"scripts":{"start":"webpack serve --config config/webpack.dev.js --open --mode development","build":"webpack --mode production --config config/webpack.prod.js","clean":"rm -rf dist","heroku-postbuild":"npm run build"},"eslintConfig":{"extends":["react-app","react-app/jest"]},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"devDependencies":{"@babel/core":"^7.17.9","@babel/preset-env":"^7.16.11","@babel/preset-react":"^7.16.7","@svgr/webpack":"^6.2.1","babel-loader":"^8.2.5","css-loader":"^6.7.1","html-webpack-plugin":"^5.5.0","serve":"^13.0.4","style-loader":"^3.3.1","url-loader":"^4.1.1","webpack":"^5.72.0","webpack-cli":"^4.9.2","webpack-dev-server":"^4.8.1","webpack-merge":"^5.8.0"}}')}}]);